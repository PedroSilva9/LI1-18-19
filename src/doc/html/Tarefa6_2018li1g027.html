<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Tarefa6_2018li1g027</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Tarefa6_2018li1g027.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Jos&#233; Pedro Silva &lt;a84577@uminho.pt&gt;<br />Rui Carvalho &lt;a89498@uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">Tarefa6_2018li1g027</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Fun&#231;&#245;es principais da Tarefa 6.</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><h1>Introdu&#231;&#227;o</h1><p>Este m&#243;dulo cont&#233;m todas as fun&#231;&#245;es relativas ao bot. Nesta tarefa estabelece-mos uma rela&#231;&#227;o de prioridade para certas jogadas do bot.</p><h1>Objetivos   </h1><ul><li>1 - Verificar se esta numa zona de perigo, isto &#233;, se pode ser afetado por um  laser ou por um canhao, caso possa, mover numa direcao que permita ao jogador estar em seguran&#231;a.</li><li>2 - Verificar se algum jogador esta na mesma &quot;linha&quot; que o jogador, e se sim, ataca o jogador.</li><li>3 - Verificar se algum jogador est&#225; num raio de 3 quadrados, caso se verifique usar choque e consequentemente na pr&#243;xima jogada disparar laser/canhao (se estiver alinhado com o jogador, caso n&#227;o esteja mudar a dire&#231;&#227;o).</li><li>4 - Verificar se esta numa zona de perigo, ie, se pode ser afetado por um laser ou por um canhao, caso possa, mover numa direcao que permita ao jogador estar em seguran&#231;a.</li><li>5 - Calcular quantos blocos destrutiveis existem na dire&#231;&#227;o do jogador, caso sejam bastantes disparar laser.</li><li>6 - Caso n&#227;o reuna nenhuma das condi&#231;&#245;es anteriores mover numa dire&#231;&#227;o de modo a aproximar-se de um jogador.</li></ul><h1>Conclus&#227;o</h1><p>Ap&#243;s a conclus&#227;o desta tarefa &#233; poss&#237;vel verificar que o bot j&#225; se consegue desviar de laser dos jogadores, atacar, apr&#243;ximar-se de outros jogadores etc... 
  O sitema de prioridades implementado torna muito mais f&#225;cil fornecer ao bot a melhor jogada poss&#237;vel. Assim, &#233; poss&#237;vel afirmar que o resultado final do bot foi bom, embora reconhecemos que o nosso objetivo principal era ter o melhor bot.
  Concluindo, apesar de alguns problemas enfrentados para fazer o bot, tais como, ele bloquear em alguns locais devido aos blocos e &#224; situa&#231;&#227;o em que se encontra, conseguimos corrigir e tornar o bot um oponente minimamente forte.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:-60-.">(&lt;.)</a> :: Maybe a -&gt; Maybe a -&gt; Maybe a</li><li class="src short"><a href="#v:dangerZoneLaser">dangerZoneLaser</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></li><li class="src short"><a href="#v:isOnPath">isOnPath</a> :: ([<a href="LI11819.html#t:Posicao">Posicao</a>], <a href="LI11819.html#t:Jogador">Jogador</a>) -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; Bool</li><li class="src short"><a href="#v:runAwayLaser">runAwayLaser</a> :: ([<a href="LI11819.html#t:Posicao">Posicao</a>], <a href="LI11819.html#t:Jogador">Jogador</a>) -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; Maybe [<a href="LI11819.html#t:Direcao">Direcao</a>]</li><li class="src short"><a href="#v:checkPossibleMove">checkPossibleMove</a> :: <a href="LI11819.html#t:Estado">Estado</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>]</li><li class="src short"><a href="#v:checkV">checkV</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; Bool</li><li class="src short"><a href="#v:direcaoInversa">direcaoInversa</a> :: <a href="LI11819.html#t:Direcao">Direcao</a> -&gt; <a href="LI11819.html#t:Direcao">Direcao</a></li><li class="src short"><a href="#v:pathCalculator">pathCalculator</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; [[<a href="LI11819.html#t:Posicao">Posicao</a>]]</li><li class="src short"><a href="#v:posDir">posDir</a> :: <a href="LI11819.html#t:Jogador">Jogador</a> -&gt; (<a href="LI11819.html#t:PosicaoGrelha">PosicaoGrelha</a>, <a href="LI11819.html#t:Direcao">Direcao</a>)</li><li class="src short"><a href="#v:dangerZoneCanhoes">dangerZoneCanhoes</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></li><li class="src short"><a href="#v:bestplay">bestplay</a> :: [Int] -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>] -&gt; <a href="LI11819.html#t:Direcao">Direcao</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Estado">Estado</a> -&gt; Maybe <a href="LI11819.html#t:Direcao">Direcao</a></li><li class="src short"><a href="#v:quantosDispCanhaoPath">quantosDispCanhaoPath</a> :: [Bool] -&gt; ([Int], Int)</li><li class="src short"><a href="#v:radiusBlock">radiusBlock</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; [<a href="LI11819.html#t:PosicaoGrelha">PosicaoGrelha</a>]</li><li class="src short"><a href="#v:inChoque">inChoque</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></li><li class="src short"><a href="#v:shootToKill">shootToKill</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></li><li class="src short"><a href="#v:shootDestructable">shootDestructable</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></li><li class="src short"><a href="#v:howManyDestructable">howManyDestructable</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; ([<a href="LI11819.html#t:Posicao">Posicao</a>], [<a href="LI11819.html#t:Posicao">Posicao</a>])</li><li class="src short"><a href="#v:findPieceDest">findPieceDest</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; Maybe <a href="LI11819.html#t:Posicao">Posicao</a></li><li class="src short"><a href="#v:aproxPlayer">aproxPlayer</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></li><li class="src short"><a href="#v:bestDir">bestDir</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>] -&gt; <a href="LI11819.html#t:Estado">Estado</a> -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>]</li><li class="src short"><a href="#v:bot">bot</a> :: Int -&gt; <a href="LI11819.html#t:Estado">Estado</a> -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:-60-." class="def">(&lt;.)</a> :: Maybe a -&gt; Maybe a -&gt; Maybe a <a href="#v:-60-." class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve o primeiro valor Just que apare&#231;a</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Just 2 &lt;. Just 3  &lt;. Nothing
</code></strong>    Just 2
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>Nothing &lt;. Just 3  &lt;. Nothing
</code></strong>    Just 3    
</pre></div></div><h1 id="g:1">Fun&#231;&#245;es principais da Tarefa 6.</h1><div class="top"><p class="src"><a id="v:dangerZoneLaser" class="def">dangerZoneLaser</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a> <a href="#v:dangerZoneLaser" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que verifica se existe algum jogador que possa atacar o bot com um laser, sendo que o bot neste caso foge.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5,Jogador (1,4) E 5 5 5] []
</code></strong>    dangerZoneLaser (e,0)
    Just (Movimenta B)
</pre><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5,Jogador (1,4) B 5 5 5] []
</code></strong>    dangerZoneLaser (e,0)
    Nothing
</pre></div></div><div class="top"><p class="src"><a id="v:isOnPath" class="def">isOnPath</a> :: ([<a href="LI11819.html#t:Posicao">Posicao</a>], <a href="LI11819.html#t:Jogador">Jogador</a>) -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; Bool <a href="#v:isOnPath" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que verifica se existe algum jogador pode atingir o bot com um 'Laser'/'Canhao'.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let pj = ([(1,1),(1,2),(2,1),(2,2)], Jogador (1,1) B 5 5 5)
</code></strong>    isOnPath pj []
    False
</pre></div></div><div class="top"><p class="src"><a id="v:runAwayLaser" class="def">runAwayLaser</a> :: ([<a href="LI11819.html#t:Posicao">Posicao</a>], <a href="LI11819.html#t:Jogador">Jogador</a>) -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; Maybe [<a href="LI11819.html#t:Direcao">Direcao</a>] <a href="#v:runAwayLaser" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que verifica se o jogador poder&#225; ser atingido pelo laser e se sim retorna as <code><a href="LI11819.html#t:Direcao">Direcao</a></code> contr&#225;ria aquelas que s&#227;o usadas para fugir.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let pj = ([(1,1),(1,2),(2,1),(2,2)], Jogador (1,1) B 5 5 5)
</code></strong>    runAwayLaser pj []
    Nothing
</pre></div></div><div class="top"><p class="src"><a id="v:checkPossibleMove" class="def">checkPossibleMove</a> :: <a href="LI11819.html#t:Estado">Estado</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>] <a href="#v:checkPossibleMove" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe um estado e uma posi&#231;&#227;o e verifica as dire&#231;&#245;es em que o jogador se pode mover</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5] []
</code></strong>    checkPossibleMove e (1,1)
    [B,D]
</pre></div></div><div class="top"><p class="src"><a id="v:checkV" class="def">checkV</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; Bool <a href="#v:checkV" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe uma posi&#231;&#227;o e um mapa e devolve se uma tanque pode avan&#231;ar para essa posi&#231;&#227;o.</p><p>Como um tanque tem de ser testado nas 4 posi&#231;&#245;es utiliza-se a fun&#231;&#227;o as <code><a href="Tarefa4_2018li1g027.html#v:asSqr">asSqr</a></code> para testar todas as posi&#231;&#245;es, enviando para a fun&#231;&#227;o auxiliar essa lista e o mapa.</p><pre>aux (asSqr p) m</pre><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>checkV (1,1) (mapaInicial (4,4))
</code></strong>    True
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>checkV (3,3) (mapaInicial (4,4))
</code></strong>    False
</pre></div></div><div class="top"><p class="src"><a id="v:direcaoInversa" class="def">direcaoInversa</a> :: <a href="LI11819.html#t:Direcao">Direcao</a> -&gt; <a href="LI11819.html#t:Direcao">Direcao</a> <a href="#v:direcaoInversa" class="selflink">#</a></p><div class="doc"><p>Calcula a dire&#231;&#227;o inversa de uma dada dire&#231;&#227;o.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>direcaInversa D
</code></strong>    E
</pre></div></div><div class="top"><p class="src"><a id="v:pathCalculator" class="def">pathCalculator</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; [[<a href="LI11819.html#t:Posicao">Posicao</a>]] <a href="#v:pathCalculator" class="selflink">#</a></p><div class="doc"><p>Calcula todas as <code><a href="LI11819.html#t:Posicao">Posicao</a></code> que podem ser afetadas por um laser de todos os <code><a href="LI11819.html#t:Jogador">Jogador</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:posDir" class="def">posDir</a> :: <a href="LI11819.html#t:Jogador">Jogador</a> -&gt; (<a href="LI11819.html#t:PosicaoGrelha">PosicaoGrelha</a>, <a href="LI11819.html#t:Direcao">Direcao</a>) <a href="#v:posDir" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve um tuplo com a posi&#231;&#227;o e dire&#231;&#227;o de um jogador.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>posDir (Jogador (1,1) D 5 5 5)
</code></strong>    ((1,1),D)
</pre></div></div><div class="top"><p class="src"><a id="v:dangerZoneCanhoes" class="def">dangerZoneCanhoes</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a> <a href="#v:dangerZoneCanhoes" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que verifica se o caminho de algum disparo Canhao interseta a posi&#231;&#227;o do bot.</p><p>Se a quantidade de disparos no <code><a href="Tarefa6_2018li1g027.html#v:radiusBlock">radiusBlock</a></code> for <strong>0</strong> ent&#227;o devolve <em>Nothing</em>.</p><pre>| qtsdispOnPath == 0 = Nothing</pre><p>Se a quantidade de disparos no <code><a href="Tarefa6_2018li1g027.html#v:radiusBlock">radiusBlock</a></code> for <strong>maior que 1 </strong> ent&#227;o ou se move ou dispara um canhao dependo se o resultado da fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:bestplay">bestplay</a></code> &#233; ou n&#227;o vazio e se na lista de disparos existe algum disparo canh&#227;o de outro jogador</p><pre> | qtsdispOnPath &gt; 1 = if isNothing bestMove || null canhoesNoBot
                          then Just $ Dispara Canhao
                          else Just $ Movimenta $ fromJust bestMove
</pre><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5] [DisparoCanhao 1 (3,1) C]
</code></strong>    dangerZoneCanhoes (e,0)
    Just (Movimenta D)
</pre></div></div><div class="top"><p class="src"><a id="v:bestplay" class="def">bestplay</a> :: [Int] -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>] -&gt; <a href="LI11819.html#t:Direcao">Direcao</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Estado">Estado</a> -&gt; Maybe <a href="LI11819.html#t:Direcao">Direcao</a> <a href="#v:bestplay" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que calcula a melhor dire&#231;&#227;o para o bot. </p><p>A fun&#231;&#227;o calcula as dire&#231;&#245;es poss&#237;veis que o bot pode seguir atrav&#233;s da fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:checkPossibleMove">checkPossibleMove</a></code> e retira dessa lista as dire&#231;&#245;es inversas do tiro para que o bot n&#227;o avan&#231;e para cima do tiro
e retira a dire&#231;&#227;o inversa do bot para que este se mova para longe do tiro.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5] [DisparoCanhao 1 (3,1) C]
</code></strong>    bestplay [0] [C] C (1,1) e  
    Just D
</pre></div></div><div class="top"><p class="src"><a id="v:quantosDispCanhaoPath" class="def">quantosDispCanhaoPath</a> :: [Bool] -&gt; ([Int], Int) <a href="#v:quantosDispCanhaoPath" class="selflink">#</a></p><div class="doc"><p>Devolve o indice dos disparos canh&#227;o que est&#227;o no caminho do bot e a quantidade. Assim sabe-se quais os indices que dos disparos com que o bot se deve preocupar.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>quantosDispCanhaoPath [True,False,True]
</code></strong>    ([0,2],2)
</pre></div></div><div class="top"><p class="src"><a id="v:radiusBlock" class="def">radiusBlock</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; [<a href="LI11819.html#t:PosicaoGrelha">PosicaoGrelha</a>] <a href="#v:radiusBlock" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve as posi&#231;&#245;es que est&#227;o &#224; num quadrado 4x4 &#224; volta de uma posi&#231;&#227;o. </p><p>Assim, &#233; poss&#237;vel o bot detetar todos os tiros que est&#227;o dentro desta &#225;rea.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>radiusBlock (2,2) (mapaInicial (5,5))
</code></strong>    [(0,0),(0,1),(0,2),(0,3),(0,4),(1,0),(1,1),(1,2),(1,3),(1,4),(2,0),(2,1),(2,2),(2,3),(2,4),(3,0),(3,1),(3,2),(3,3),(3,4),(4,0),(4,1),(4,2),(4,3),(4,4)]
</pre></div></div><div class="top"><p class="src"><a id="v:inChoque" class="def">inChoque</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a> <a href="#v:inChoque" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que verifica se o bot tem algum jogador dentro da &#225;rea de choque dele para poder disparar o choque.</p><p>A fun&#231;&#227;o apenas ativa o choque se j&#225; n&#227;o tiver um ativado e se a muni&#231;&#227;o do choque &#233; superior a 0</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5, Jogador (2,2) C 5 5 5] []
</code></strong>    inChoque (e,0)
    Just (Dispara Choque)
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5, Jogador (6,6) C 5 5 5] []
</code></strong>    inChoque (e,0)
    Nothing
</pre></div></div><div class="top"><p class="src"><a id="v:shootToKill" class="def">shootToKill</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a> <a href="#v:shootToKill" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dispara ou um laser ou um tiro canh&#227;o (se n&#227;o tiver muni&#231;&#245;es do laser) quando um jogador aparece no caminho do bot.</p><pre>if laserAmmo &gt; 0 then Just $ Dispara Laser else Just $ Dispara Canhao</pre><p>A fun&#231;&#227;o filtra a lista de jogadores sem o bot pelos jogadores que ainda est&#227;o vivos e calcula o caminho do bot at&#233; atingir um bloco indestrutivel.
Se algum dos jogadores estiver no caminho o bot ataca.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) D 5 5 5, Jogador (1,6) C 5 5 5] []
</code></strong>    shootToKill (e,0)
    Just (Dispara Laser)
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5, Jogador (1,6) C 5 5 5] []
</code></strong>    shootToKill (e,0)
    Nothing
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 0 5, Jogador (6,1) C 5 5 5] []
</code></strong>    shootToKill (e,0)
    Just (Dispara Canhao)
</pre></div></div><div class="top"><p class="src"><a id="v:shootDestructable" class="def">shootDestructable</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a> <a href="#v:shootDestructable" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dispara contra blocos destrutiveis se estes estiverem no caminho do bot.</p><p>Se o bot tiver 4 ou mais blocos no caminho e a muni&#231;&#227;o do laser for superior a 0 ent&#227;o dispara um laser.</p><pre>| howManyOnPath &gt;= 4 &amp;&amp; laserAmmo &gt; 0 = Just $ Dispara Laser</pre><p>Se tiver algum no caminho ent&#227;o dispara um tiro de canh&#227;o, sen&#227;o nao dispara nada </p><pre> | howManyOnPath &gt; 0 = Just $ Dispara Canhao
 | otherwise = Nothing
</pre><h3>Mapa com 4 blocos destrutivel no caminho: </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let m = [[Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Bloco Destrutivel,Bloco Destrutivel,Bloco Destrutivel,Bloco Destrutivel,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel]]
</code></strong>    shootDestructable (e,0)
    Just (Dispara Laser)
</pre><h3>Mesmo mapa mas sem lasers:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let m = [[Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Bloco Destrutivel,Bloco Destrutivel,Bloco Destrutivel,Bloco Destrutivel,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Vazia,Bloco Indestrutivel],[Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel,Bloco Indestrutivel]]
</code></strong>    shootDestructable (e,0)
    Just (Dispara Canh&#227;o)
</pre></div></div><div class="top"><p class="src"><a id="v:howManyDestructable" class="def">howManyDestructable</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; ([<a href="LI11819.html#t:Posicao">Posicao</a>], [<a href="LI11819.html#t:Posicao">Posicao</a>]) <a href="#v:howManyDestructable" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe um estado e um int e devolve um tuplo com a lista de posi&#231;&#245;es com blocos destrut&#237;veis e o caminho para eles.</p><p>Esta fun&#231;&#227;o utiliza a fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:findPieceDest">findPieceDest</a></code> para verificar se numa posi&#231;&#227;o a pe&#231;a <strong>&#233; destrut&#237;vel</strong> ou n&#227;o, devolvendo a posi&#231;&#227;o se for.</p><h3>Exemplo de utiliza&#231;&#227;o (Usando o mapa do exemplo da fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:shootDestructable">shootDestructable</a></code> :</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>howManyDestructable (e,0)
</code></strong>    ([(1,5),(1,6),(1,7),(1,8)] , [(1,2),(1,3),(1,4),(1,5),(1,6),(1,7),(1,8),(1,9),(2,2),(2,3),(2,4),(2,5),(2,6),(2,7),(2,8),(2,9)])
</pre></div></div><div class="top"><p class="src"><a id="v:findPieceDest" class="def">findPieceDest</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; Maybe <a href="LI11819.html#t:Posicao">Posicao</a> <a href="#v:findPieceDest" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que verifica se numa dada posicao a pe&#231;a &#233; destrut&#237;vel, retornando a posi&#231;&#227;o se for.</p><h3>Exemplo de utiliza&#231;&#227;o (Usando o mapa do exemplo da fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:shootDestructable">shootDestructable</a></code> :</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>findPieceDest m (4,4)
</code></strong>    Nothing
</pre><h3>Exemplo de utiliza&#231;&#227;o (Usando o mapa do exemplo da fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:shootDestructable">shootDestructable</a></code> :</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>findPieceDest m (1,6)
</code></strong>    Just (1,6)
</pre></div></div><div class="top"><p class="src"><a id="v:aproxPlayer" class="def">aproxPlayer</a> :: (<a href="LI11819.html#t:Estado">Estado</a>, Int) -&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a> <a href="#v:aproxPlayer" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que aproxima o bot de outro jogador.</p><p>Esta fun&#231;&#227;o filtra a lista dos jogadores sem o bot por aqueles que ainda est&#227;o vivos. </p><pre> (allPlayers, bot) = (jogadoresEstado e, allPlayers !! ind)
 semBot            = deleteN ind allPlayers
 alivePlayers      = filter (x -&gt; vidasJogador x /= 0) semBot
</pre><p>Posteriormente calcula a posi&#231;&#227;o do jogador e a posi&#231;&#227;o do jogador mais pr&#243;ximo atrav&#233;s da fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:calculaPosMaisProx">calculaPosMaisProx</a></code></p><pre>jogadorMaisProx   = calculaPosMaisProx botPos semBotPos </pre><p>Usando a fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:checkPossibleMove">checkPossibleMove</a></code> recebe a lista das dire&#231;&#245;es que o bot pode utilizar.</p><pre>availableDirs = checkPossibleMove e botPos</pre><p>E usa a fun&#231;&#227;o <code><a href="Tarefa6_2018li1g027.html#v:bestDir">bestDir</a></code> para calcular a lista de dire&#231;&#245;es que o bot se pode mover retirando a dire&#231;&#227;o inversa do bot para ele n&#227;o voltar para tr&#225;s.</p><pre>bestDir botPos semBotPos (availableDirs \\ [direcaoInversa $ direcaoJogador bot]) e  </pre><p>Assim se esta lista for vazia a fun&#231;&#227;o devolve nothing, sen&#227;o devolve a <code><a href="LI11819.html#t:Jogada">Jogada</a></code> <code><a href="LI11819.html#v:Movimenta">Movimenta</a></code> com a primeira dire&#231;&#227;o da lista </p><pre>if null bestDirToMove then Nothing else Just . Movimenta $ (head bestDirToMove)</pre><p>Assim o bot move-se para junto de um jogador onde posteriormente pode atacar ou n&#227;o dependendo do resultado de outras fun&#231;&#245;es </p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5, Jogador (1,6) C 5 5 5] []
</code></strong>    aproxPlayer (e,0)
    Just (Movimenta D)
</pre></div></div><div class="top"><p class="src"><a id="v:bestDir" class="def">bestDir</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>] -&gt; <a href="LI11819.html#t:Estado">Estado</a> -&gt; [<a href="LI11819.html#t:Direcao">Direcao</a>] <a href="#v:bestDir" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que calcula a lista com as melhores dire&#231;&#245;es que o bot se pode movimentar.</p><p>A fun&#231;&#227;o calcula as posi&#231;&#245;es possiveis do bot onde o bot pode de facto se mover.</p><pre>  l                = map direcaoParaVetor dirList
  mapa             = mapaEstado e
  listPosVazia     = checkPosVazia mapa
  possibleBotPos   = map (somaVetores p) l
</pre><p>Posteriormente calcula o jogador mais pr&#243;ximo e a posi&#231;&#227;o que o bot se pode mover mais pr&#243;xima do jogador:</p><pre> jogadorMaisProx  = calculaPosMaisProx p jogPosList 
 nextPos          = calculaPosMaisProx jogadorMaisProx possibleBotPos
</pre><p>Assim se esta lista de posi&#231;&#245;es for nula ent&#227;o o bot n&#227;o se pode mover em nenhuma dire&#231;&#227;o, sen&#227;o devolve a dire&#231;&#227;o correspondente ao &#237;ndice da posi&#231;&#227;o mais pr&#243;xima na lista de posi&#231;&#245;es.</p><pre>if null nextPos then [] else [dirList !! fromJust (elemIndex nextPos possibleBotPos)]</pre><h3>Exemplo de utiliza&#231;&#227;o :</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5, Jogador (3,3) C 5 5 5] []
</code></strong>    bestDir (1,1) [(3,3)] [D,B] e 
    [D]
</pre></div></div><div class="top"><p class="src"><a id="v:bot" class="def">bot</a> <a href="#v:bot" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: Int</td><td class="doc"><p>O identificador do <code><a href="LI11819.html#t:Jogador">Jogador</a></code> associado ao ro<code><a href="Tarefa6_2018li1g027.html#v:bot">bot</a></code>.</p></td></tr><tr><td class="src">-&gt; <a href="LI11819.html#t:Estado">Estado</a></td><td class="doc"><p>O <code><a href="LI11819.html#t:Estado">Estado</a></code> para o qual o ro<code><a href="Tarefa6_2018li1g027.html#v:bot">bot</a></code> deve tomar uma decis&#227;o.</p></td></tr><tr><td class="src">-&gt; Maybe <a href="LI11819.html#t:Jogada">Jogada</a></td><td class="doc"><p>Uma poss&#237;vel <code><a href="LI11819.html#t:Jogada">Jogada</a></code> a efetuar pelo ro<code><a href="Tarefa6_2018li1g027.html#v:bot">bot</a></code>.</p></td></tr></table></div><div class="doc"><p>Define um ro<code><a href="Tarefa6_2018li1g027.html#v:bot">bot</a></code> capaz de jogar autonomamente o jogo.</p><p>Como mencionado anteriormente definimos uma lista de prioridades na qual se pode definir de forma simples atrav&#233;s da fun&#231;&#227;o '(&lt;.)'.</p><p>Esta fun&#231;&#227;o foi criada para facilitar o processo de tomada de decis&#227;o do bot.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) B 5 5 5, Jogador (3,3) C 5 5 5] []
</code></strong>    bot 0 e
    Just (Movimenta D)
</pre><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>let e = Estado (mapaInicial (10,10)) [Jogador (1,1) D 5 5 5, Jogador (1,6) C 5 5 5] []
</code></strong>    bot 0 e
    Just (Dispara Laser)
</pre></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>
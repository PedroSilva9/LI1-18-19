<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>DesenhaJogo</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_DesenhaJogo.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption empty">&nbsp;</p></div><div id="content"><div id="module-header"><table class="info"><tr><th valign="top">Copyright</th><td>Jos&#233; Pedro Silva &lt;a84577@uminho.pt&gt;<br />Rui Carvalho &lt;a89498@uminho.pt&gt;</td></tr><tr><th>Safe Haskell</th><td>None</td></tr></table><p class="caption">DesenhaJogo</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Fun&#231;&#245;es principais para desenhar o Estado.</a></li><li><a href="#g:2">Fun&#231;&#245;es complementares para desenhar o criador de mapas ou desenhar o mapa do jogo.</a></li><li><a href="#g:3">Fun&#231;&#245;es relacionadas com a posi&#231;&#227;o dos tanques.</a></li><li><a href="#g:4">Fun&#231;&#245;es para desenhar tanques.</a></li><li><a href="#g:5">Fun&#231;&#245;es para desenhar tiros.</a></li><li><a href="#g:6">Fun&#231;&#245;es para desenhar o contador de ticks.</a></li><li><a href="#g:7">Fun&#231;&#245;es para desenhar os powerups.</a></li><li><a href="#g:8">Fun&#231;&#245;es para desenhar o estado dos jogadores.</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Por&#231;&#227;o de c&#243;digo da tarefa 5 que permite desenhar o jogo, mais precisamente, os tanques, o mapa, os tiros e toda a informa&#231;&#227;o relativa ao estado dos jogadores.</p><p>Permite tamb&#233;m desenhar o construtor de mapas no ecr&#227;, bem como o tetr&#243;mino e todo o seu movimento e as intru&#231;&#245;es de como utiliz&#225;-lo.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:deleteN">deleteN</a> :: Int -&gt; [a] -&gt; [a]</li><li class="src short"><a href="#v:desenhaEstado">desenhaEstado</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:desenhaJogo">desenhaJogo</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:desenhaCriaMapa">desenhaCriaMapa</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:desenhaInfoCM">desenhaInfoCM</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:desenhaMapa">desenhaMapa</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; Float -&gt; Float -&gt; Float -&gt; Float -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaLinha">desenhaLinha</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Float -&gt; Float -&gt; Float -&gt; [<a href="LI11819.html#t:Peca">Peca</a>] -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaPeca">desenhaPeca</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Peca">Peca</a> -&gt; Picture</li><li class="src short"><a href="#v:pecaSize">pecaSize</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; (Float, Float)</li><li class="src short"><a href="#v:getPecaPos">getPecaPos</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; (Float, Float)</li><li class="src short"><a href="#v:posTank">posTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [<a href="LI11819.html#t:Jogador">Jogador</a>]</li><li class="src short"><a href="#v:bestPosTank">bestPosTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a></li><li class="src short"><a href="#v:checkPosVazia">checkPosVazia</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>]</li><li class="src short"><a href="#v:posOndeCabemTanques">posOndeCabemTanques</a> :: [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>]</li><li class="src short"><a href="#v:posVazia">posVazia</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; [[<a href="LI11819.html#t:Posicao">Posicao</a>]] -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>]</li><li class="src short"><a href="#v:calculaPosMaisProx">calculaPosMaisProx</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; <a href="LI11819.html#t:Posicao">Posicao</a></li><li class="src short"><a href="#v:distMenor">distMenor</a> :: [Float] -&gt; Int</li><li class="src short"><a href="#v:dist">dist</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; Float</li><li class="src short"><a href="#v:desenhaTanques">desenhaTanques</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaTank">desenhaTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Jogador">Jogador</a> -&gt; Picture -&gt; Picture</li><li class="src short"><a href="#v:direcaoToAngle">direcaoToAngle</a> :: <a href="LI11819.html#t:Direcao">Direcao</a> -&gt; Float</li><li class="src short"><a href="#v:pictureTank">pictureTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture]</li><li class="src short"><a href="#v:desenhaTiro">desenhaTiro</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture]</li><li class="src short"><a href="#v:drawLaserPath">drawLaserPath</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Disparo">Disparo</a> -&gt; Picture</li><li class="src short"><a href="#v:resizeTiro">resizeTiro</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Disparo">Disparo</a> -&gt; Picture -&gt; Picture</li><li class="src short"><a href="#v:pictureTiro">pictureTiro</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Disparo">Disparo</a> -&gt; Picture</li><li class="src short"><a href="#v:drawTicksCounter">drawTicksCounter</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:desenhaTick">desenhaTick</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Float -&gt; Picture -&gt; Picture</li><li class="src short"><a href="#v:pictureTick">pictureTick</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Char -&gt; Picture</li><li class="src short"><a href="#v:desenhaPowerUps">desenhaPowerUps</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture]</li><li class="src short"><a href="#v:resizePowerUp">resizePowerUp</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="Typos.html#t:Powerup">Powerup</a> -&gt; Picture -&gt; Picture</li><li class="src short"><a href="#v:picturePowerUp">picturePowerUp</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="Typos.html#t:Powerup">Powerup</a> -&gt; Picture</li><li class="src short"><a href="#v:getEstados">getEstados</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:desenhaEstadoJog">desenhaEstadoJog</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Int -&gt; Picture</li><li class="src short"><a href="#v:estadoJog">estadoJog</a> :: Int -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture</li><li class="src short"><a href="#v:desenhaInfo">desenhaInfo</a> :: Int -&gt; Float -&gt; Float -&gt; Float -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture -&gt; Picture</li><li class="src short"><a href="#v:resizeVLC">resizeVLC</a> :: String -&gt; String -&gt; String -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Float -&gt; Float -&gt; Float -&gt; Picture</li><li class="src short"><a href="#v:placeN">placeN</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; String -&gt; Int -&gt; Float -&gt; Float -&gt; Float -&gt; Float -&gt; Float -&gt; [Picture]</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:deleteN" class="def">deleteN</a> :: Int -&gt; [a] -&gt; [a] <a href="#v:deleteN" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que apaga um elemento num determinado &#237;ndice de uma lista.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>deteleN 2 [1,2,3,4] = [1,2,4]
</code></strong></pre></div></div><h1 id="g:1">Fun&#231;&#245;es principais para desenhar o Estado.</h1><div class="top"><p class="src"><a id="v:desenhaEstado" class="def">desenhaEstado</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture <a href="#v:desenhaEstado" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que mediante os valores l&#243;gicos das vari&#225;veis <code><a href="Typos.html#v:menu">menu</a></code> e <code><a href="Typos.html#v:criaMapa">criaMapa</a></code> desenha imagens na tela do jogo.</p><p>Se o valor de <code><a href="Typos.html#v:menu">menu</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> for verdade ent&#227;o o utilizador est&#225; no menu e o programa faz aparecer a imagem do menu que se encontra no <code><a href="Typos.html#v:tMenu">tMenu</a></code> atual.</p><p>Se o <code><a href="Typos.html#v:criaMapa">criaMapa</a></code> for verdade e o <code><a href="Typos.html#v:menu">menu</a></code> falso ent&#227;o a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:desenhaCriaMapa">desenhaCriaMapa</a></code> passando como argumento o mapa do <code><a href="Typos.html#v:editor">editor</a></code> e o <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> atual.</p><p>Se Nenhum dos anteriores for verdade ent&#227;o quer dizer que o utilizador se encontra realmente no jogo e chama a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:desenhaJogo">desenhaJogo</a></code> passando o <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> como argumento</p></div></div><div class="top"><p class="src"><a id="v:desenhaJogo" class="def">desenhaJogo</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture <a href="#v:desenhaJogo" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha todos os elementos do jogo, sendo que, vai buscar as diferentes pictures &#224;s funcoes correspondestes agrupando-as numa s&#243; lista e recorrendo &#224; fun&#231;&#227;o Pictures forma s&#243; uma picture.</p><p>Esta fun&#231;&#227;o relaciona as seguintes fun&#231;&#245;es: </p><ul><li><code><a href="DesenhaJogo.html#v:desenhaCriaMapa">desenhaCriaMapa</a></code> que desenha na tela do jogo o mapa no criador de mapas e a informa&#231;&#227;o relativa ao tetr&#243;mino ou s&#243; desenha o mapa se estiver no jogo.</li><li><code><a href="DesenhaJogo.html#v:desenhaTanques">desenhaTanques</a></code> que como o nome indica desenha os tanques nas posi&#231;&#245;es mais pr&#243;ximas dos cantos do mapa.</li><li><code><a href="DesenhaJogo.html#v:desenhaTiro">desenhaTiro</a></code> que desenha todos os tiros sendo eles o laser, canh&#227;o e choque</li><li><code><a href="DesenhaJogo.html#v:desenhaPowerUps">desenhaPowerUps</a></code> que desenha os powerups no mapa.</li><li><code><a href="DesenhaJogo.html#v:drawTicksCounter">drawTicksCounter</a></code> que faz com que apare&#231;a um contador de ticks na parte inferior da tela.</li><li><code><a href="DesenhaJogo.html#v:getEstados">getEstados</a></code> que desenha os estados dos tanques durante o jogo , tal como, as vidas, muni&#231;&#245;es etc... </li></ul></div></div><div class="top"><p class="src"><a id="v:desenhaCriaMapa" class="def">desenhaCriaMapa</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture <a href="#v:desenhaCriaMapa" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o usada para desenhar o criador de mapas ou o mapa do jogo que recebe um <code><a href="LI11819.html#t:Mapa">Mapa</a></code> e um <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> e devolve a picture do <code><a href="LI11819.html#t:Mapa">Mapa</a></code>. </p><p>A Fun&#231;&#227;o calcula o tamanho ideal de uma pe&#231;a atrav&#233;s da fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:pecaSize">pecaSize</a></code> e recebe a posicao do mapa enviando para a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:desenhaMapa">desenhaMapa</a></code> estas vari&#225;veis como argumento recebendo a picture do mapa.</p><pre> (bSize,pixelSize) = pecaSize e m
 criaM             = criaMapa e 
 (posX,posY)       = getPecaPos e m
 getInfo           = desenhaInfoCM e
 getMapaPic        = desenhaMapa m posX posY bSize pixelSize e
</pre><p>Posteriormente a fun&#231;&#227;o guarda na vari&#225;vel getInfo o resultado da fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:desenhaInfoCM">desenhaInfoCM</a></code> que &#233; respons&#225;vel por desenhar no ecr&#227; a imagem das informa&#231;&#245;es relativas ao tetr&#243;mino, ou seja, as teclas a clicar para rod&#225;-lo, mov&#234;-lo etc...</p><pre>getInfo = desenhaInfoCM e</pre><p>Atr&#225;ves do valor da vari&#225;vel <code><a href="Typos.html#v:criaMapa">criaMapa</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> a fun&#231;&#227;o verifica se o utilizador est&#225; no criador de mapas ou no jogo e assim desenha o mapa e as informa&#231;&#245;es do tetr&#243;mino no primeiro caso ou entao s&#243; desenha o mapa se se encontrar na segunda situa&#231;&#227;o.</p><pre>if criaM then Pictures getMapAndInfo else Pictures getMapaPic </pre></div></div><h1 id="g:2">Fun&#231;&#245;es complementares para desenhar o criador de mapas ou desenhar o mapa do jogo.</h1><div class="top"><p class="src"><a id="v:desenhaInfoCM" class="def">desenhaInfoCM</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture <a href="#v:desenhaInfoCM" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha a informa&#231;&#227;o do criador de mapas na tela do jogo.</p><p>A informa&#231;&#227;o &#233; desenhada relativa ao tamanho da tela usando apenas o espa&#231;o do lado direito do mapa. Assim a imagem da informa&#231;&#227;o &#233; tamb&#233;m redimensionada para se ajustar &#224; tela do jogo.</p><pre>(fromIntegral x - 500 - realPixelSize * (fromIntegral . length . head $ mapa))/3</pre></div></div><div class="top"><p class="src"><a id="v:desenhaMapa" class="def">desenhaMapa</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; Float -&gt; Float -&gt; Float -&gt; Float -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture] <a href="#v:desenhaMapa" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha o mapa na tela do jogo.</p><p>Esta fun&#231;&#227;o desenha linha a linha o mapa, sendo que utiliza a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:desenhaLinha">desenhaLinha</a></code> usando como valor para <code>Scale</code> o melhor tamanho para a pe&#231;a obtido atrav&#233;s da fun&#231;&#227;o <code>sizePeca</code>.</p><pre>pic = Translate posI 0 $ Scale sizePecaToScale sizePecaToScale $ desenhaPeca e h</pre><p>Quando uma linha &#233; desenha a proxima ser&#225; desenhada pelo mesmo processo mas ser&#225; feita uma transla&#231;&#227;o para baixo sendo que o tamanho somado &#233; o tamanho de uma pe&#231;a em pixeis.</p><pre>pic : desenhaMapa t posx (posy+pixelPecaSize) bestSizeToScale pixelPecaSize e</pre></div></div><div class="top"><p class="src"><a id="v:desenhaLinha" class="def">desenhaLinha</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Float -&gt; Float -&gt; Float -&gt; [<a href="LI11819.html#t:Peca">Peca</a>] -&gt; [Picture] <a href="#v:desenhaLinha" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha uma linha do mapa.</p><p>Esta fun&#231;&#227;o usa a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:desenhaPeca">desenhaPeca</a></code> para obter a imagem da pe&#231;a e redimensiona atrav&#233;s do melhor tamanho para a pe&#231;a.</p><pre>pic = Translate posI 0 $ Scale sizePecaToScale sizePecaToScale $ desenhaPeca e h</pre><p>Esta pe&#231;a nunca tem uma transla&#231;&#227;o no eixo y ficando assim sempre na mesma linha. O que acontece nesta fun&#231;&#227;o &#233; semelhante ao que acontece na <code><a href="DesenhaJogo.html#v:desenhaMapa">desenhaMapa</a></code> e a pe&#231;a sofre uma transla&#231;&#227;o no eixo x 
somando o valor do tamanho de uma pe&#231;a em pixeis para que fiquem todas seguidas na mesma linha.</p><pre>pic : desenhaLinha e (posI+sizePixelPeca) sizePixelPeca sizePecaToScale t</pre></div></div><div class="top"><p class="src"><a id="v:desenhaPeca" class="def">desenhaPeca</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Peca">Peca</a> -&gt; Picture <a href="#v:desenhaPeca" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que vai buscar a lista de <code><a href="Typos.html#v:imagensJogo">imagensJogo</a></code> &#224;s <code><a href="Typos.html#v:imagens">imagens</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> e recebe uma pe&#231;a, sendo que, mediante esta retorna a imagem correspondete na lista</p></div></div><div class="top"><p class="src"><a id="v:pecaSize" class="def">pecaSize</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; (Float, Float) <a href="#v:pecaSize" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe um <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> e um <code><a href="LI11819.html#t:Mapa">Mapa</a></code> e devolve um tuplo com o melhor tamanho para redimensionar a pe&#231;a e o seu tamanho em pixeis.</p><p>Um dos problemas ao desenhar o mapa foi o facto de que muitas vezes este sa&#237;a do seu espa&#231;o no ecr&#227;. Deste modo, estabelece-se uma rela&#231;&#227;o entre o largura e a altura do ecr&#227; e do mapa e verifica-se aquela que melhor
se adequa de forma a caber o no espa&#231;o estabelecido. Assim, este valor para utilizar a fun&#231;&#227;o <code>Scale</code> acaba por ser o que faz com que o mapa n&#227;o exceda certos limites e v&#225; ficando cada vez mais pequeno &#224; medida que 
v&#227;o sendo criadas novas linhas.</p><pre> sizePecaX     = fromIntegral a *0.5 / fromIntegral (tlinha * 100)
 sizePecaY     = fromIntegral b *0.8 / fromIntegral (tcol * 100)
 bestSize      = if sizePecaY &gt; sizePecaX then sizePecaX else sizePecaY
 pixelPecaSize = bestSize * 100
</pre></div></div><div class="top"><p class="src"><a id="v:getPecaPos" class="def">getPecaPos</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; (Float, Float) <a href="#v:getPecaPos" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que obt&#233;m um tuplo com a posicao x e y da pe&#231;a que tamb&#233;m vai ser usada por outras fun&#231;&#245;es tais como a <code><a href="DesenhaJogo.html#v:desenhaTanques">desenhaTanques</a></code> ou <code><a href="DesenhaJogo.html#v:resizeTiro">resizeTiro</a></code>.</p></div></div><h1 id="g:3">Fun&#231;&#245;es relacionadas com a posi&#231;&#227;o dos tanques.</h1><div class="top"><p class="src"><a id="v:posTank" class="def">posTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [<a href="LI11819.html#t:Jogador">Jogador</a>] <a href="#v:posTank" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve a lista dos jogadores com as posi&#231;&#245;es mais perto dos cantos do mapa poss&#237;vel.</p><p>Um dos problemas enfrentado com a possibilidade de se fornecer ao utilizar a op&#231;&#227;o de criar um mapa foi a probabilidade deste poder desenhar um bloco destrut&#237;vel ou indestrut&#237;vel num dos cantos do mapa
e por isso torna essa posi&#231;&#227;o imposs&#237;vel de ser ocupada por um tanque.</p><p>A posi&#231;&#227;o do tanque ser&#225; calculada atrav&#233;s da fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:bestPosTank">bestPosTank</a></code> passando como argumente o <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> e as posi&#231;&#245;es que se econtram nas extremidades do mapa para esta devolver
a posi&#231;&#227;o vazia onde o tanque pode de facto ser colocado. </p><pre> jog1 = Jogador (bestPosTank e (0,0))   B 5 5 5
 jog2 = Jogador (bestPosTank e (li,co)) C 5 5 5
 jog3 = Jogador (bestPosTank e (0,co))  E 5 5 5
 jog4 = Jogador (bestPosTank e (li,0))  D 5 5 5
</pre></div></div><div class="top"><p class="src"><a id="v:bestPosTank" class="def">bestPosTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> <a href="#v:bestPosTank" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que calcula a posicao vazia onde cabe um tanque mais pr&#243;xima da posi&#231;&#227;o fornecida. </p><p>Esta fun&#231;&#227;o relaciona 2 fun&#231;&#245;es:</p><ul><li><code><a href="DesenhaJogo.html#v:checkPosVazia">checkPosVazia</a></code> que devolve todas as posi&#231;&#245;es vazias onde cabem tanques.</li><li><code><a href="DesenhaJogo.html#v:calculaPosMaisProx">calculaPosMaisProx</a></code> que calcula a posi&#231;&#227;o mais pr&#243;xima numa lista de posi&#231;&#245;es. </li></ul></div></div><div class="top"><p class="src"><a id="v:checkPosVazia" class="def">checkPosVazia</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] <a href="#v:checkPosVazia" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que recebe um mapa e devolve todas as posic&#245;es vazias onde cabem tanques</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>checkPosVazia $ mapaInicial (4,4)
</code></strong>    [(1,1)]
</pre><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>checkPosVazia $ mapaInicial (8,8)
</code></strong>    [(1,1),(1,2),(1,3),(1,4),(1,5),(2,1),(2,2),(2,3),(2,4),(2,5),(3,1),(3,2),(3,3),(3,4),(3,5),(4,1),(4,2),(4,3),(4,4),(4,5),(5,1),(5,2),(5,3),(5,4),(5,5)]
</pre></div></div><div class="top"><p class="src"><a id="v:posOndeCabemTanques" class="def">posOndeCabemTanques</a> :: [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] <a href="#v:posOndeCabemTanques" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dada uma lista de posi&#231;&#245;es retira aquelas onde o tanque n&#227;o cabe com as suas 4 posi&#231;&#245;es.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>posOndeCabemTanques [(1,1),(1,2),(1,3),(1,4),(2,1),(2,2),(2,3),(2,4),(3,1),(3,2),(3,3),(3,4),(4,1),(4,2),(4,3),(4,4)]
</code></strong>    [(1,1),(1,2),(1,3),(2,1),(2,2),(2,3),(3,1),(3,2),(3,3)]
</pre></div></div><div class="top"><p class="src"><a id="v:posVazia" class="def">posVazia</a> :: <a href="LI11819.html#t:Mapa">Mapa</a> -&gt; [[<a href="LI11819.html#t:Posicao">Posicao</a>]] -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] <a href="#v:posVazia" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dado um mapa e as posic&#245;es todas do mapa devolve a lista de todas as posi&#231;&#245;es vazias.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>posVazia (mapaInicial (6,6)) [[(0,0),(0,1),(0,2),(0,3),(0,4),(0,5)],[(1,0),(1,1),(1,2),(1,3),(1,4),(1,5)],[(2,0),(2,1),(2,2),(2,3),(2,4),(2,5)],[(3,0),(3,1),(3,2),(3,3),(3,4),(3,5)],[(4,0),(4,1),(4,2),(4,3),(4,4),(4,5)],[(5,0),(5,1),(5,2),(5,3),(5,4),(5,5)]]
</code></strong>   [(1,1),(1,2),(1,3),(1,4),(2,1),(2,2),(2,3),(2,4),(3,1),(3,2),(3,3),(3,4),(4,1),(4,2),(4,3),(4,4)]
</pre></div></div><div class="top"><p class="src"><a id="v:calculaPosMaisProx" class="def">calculaPosMaisProx</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; [<a href="LI11819.html#t:Posicao">Posicao</a>] -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> <a href="#v:calculaPosMaisProx" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que dada uma posi&#231;&#227;o e uma lista de posi&#231;&#245;es devolve a mais pr&#243;xima que est&#225; na lista.</p><h3>Exemplo de utiliza&#231;&#227;o:</h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>calculaPosMaisProx (7,7) [(1,1),(1,2),(1,3),(1,4),(2,1),(2,2),(2,3),(2,4),(3,1),(3,2),(3,3),(3,4),(4,1),(4,2),(4,3),(4,4)]
</code></strong>   (4,4)
</pre></div></div><div class="top"><p class="src"><a id="v:distMenor" class="def">distMenor</a> :: [Float] -&gt; Int <a href="#v:distMenor" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve o &#237;ndice do valor mais baixo de uma lista de dist&#226;ncias.</p><h3>Exemplo de utiliza&#231;&#227;o: </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>distMenor [2.77,5.45,1.36]
</code></strong>    2 
</pre><h3>Exemplo de utiliza&#231;&#227;o: </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>distMenor [1.89,5.45,1.36,1.00]
</code></strong>    3
</pre></div></div><div class="top"><p class="src"><a id="v:dist" class="def">dist</a> :: <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; <a href="LI11819.html#t:Posicao">Posicao</a> -&gt; Float <a href="#v:dist" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que calcula a dist&#226;ncia entre dois pontos.</p><h3>Exemplo de utiliza&#231;&#227;o: </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>dist (4,5) (2,2)
</code></strong>    3.6055512
</pre></div></div><h1 id="g:4">Fun&#231;&#245;es para desenhar tanques.</h1><div class="top"><p class="src"><a id="v:desenhaTanques" class="def">desenhaTanques</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture] <a href="#v:desenhaTanques" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve uma lista de <code>Picture</code> contendo as imagens dos tanques nas posi&#231;&#245;es corretas.</p><p>Esta fun&#231;&#227;o utiliza uma auxiliar que utiliza a lista de jogadores e a as imagens que se obt&#233;m no <code><a href="DesenhaJogo.html#v:pictureTank">pictureTank</a></code> e atrav&#233;s do indice do jogador utiliza a imagem do tanque correspondente.</p><pre>aux e listJogadores listPictures</pre><p>Existe tamb&#233;m a verifica&#231;&#227;o se o jogador tem ainda vidas e se sim ent&#227;o desenha o jogador sen&#227;o continua a chamar a fun&#231;&#227;o ignorando esse jogador. Assim resolve-se o problema dos tanques que j&#225; foram destru&#237;dos de continuarem a ser desenhados.</p><pre> if vidasJogador jog &gt; 0
 then desenhaTank e jog pic : aux e jogs pics
 else aux e jogs pics
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaTank" class="def">desenhaTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Jogador">Jogador</a> -&gt; Picture -&gt; Picture <a href="#v:desenhaTank" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o complementar da <code><a href="DesenhaJogo.html#v:desenhaTanques">desenhaTanques</a></code> que trata de desenhar <strong>apenas um tanque</strong> e coloc&#225;-lo na posi&#231;&#227;o correta.</p><p>Como a imagem do tanque &#233; 2 vezes o tamanho de uma pe&#231;a ent&#227;o a vari&#225;vel do tamanho para dar <code>Scale</code> de uma pe&#231;a que se obt&#233;m da fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:pecaSize">pecaSize</a></code> ter&#225; de ser o dobro para o tanque.</p><pre>  (sizeToScale,realPixelSize) = pecaSize e mapa
  (posX,posY)                 = getPecaPos e mapa
  resizeTank                  = scale (sizeToScale*2) (sizeToScale*2) pic  
</pre><p>Ap&#243;s isto &#233; feita uma rota&#231;&#227;o segundo a dire&#231;&#227;o do tanque usando a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:direcaoToAngle">direcaoToAngle</a></code> </p><pre>rotateTank = Rotate (direcaoToAngle dir) resizeTank</pre><p>Posteriormente o tanque sofre uma transla&#231;&#227;o que utiliza a posicao da pe&#231;a e a posi&#231;&#227;o do tanque mutliplicando pelo tamanho da pe&#231;a ficando no lugar correto. 
<code>
 (a,b) = (posX + (realPixelSize<em>2) +realPixelSize*fromIntegral y, posY + (realPixelSize </em> 2) + realPixelSize * fromIntegral x)
 translateTank = Translate a (-b) rotateTank
</code></p></div></div><div class="top"><p class="src"><a id="v:direcaoToAngle" class="def">direcaoToAngle</a> :: <a href="LI11819.html#t:Direcao">Direcao</a> -&gt; Float <a href="#v:direcaoToAngle" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que calcula o &#226;ngulo atrav&#233;s da dire&#231;&#227;o.</p><h3>Exemplo de utiliza&#231;&#227;o: </h3><pre class="screen"><code class="prompt">&gt;&gt;&gt; </code><strong class="userinput"><code>direcaoToAngle B
</code></strong>    180.0
</pre></div></div><div class="top"><p class="src"><a id="v:pictureTank" class="def">pictureTank</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture] <a href="#v:pictureTank" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que vai buscar as 4 imagens dos tanques &#224;s <code><a href="Typos.html#v:imagensJogo">imagensJogo</a></code> do par&#226;metro <code><a href="Typos.html#v:imagens">imagens</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code></p></div></div><h1 id="g:5">Fun&#231;&#245;es para desenhar tiros.</h1><div class="top"><p class="src"><a id="v:desenhaTiro" class="def">desenhaTiro</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture] <a href="#v:desenhaTiro" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o principal do desenhaTiro que filtra a lista dos disparos pelos diferentes tiros para que a lista de <code>Picture</code> final tenha os lasers como &#250;ltimos elementos da lista e assim usando a fun&#231;&#227;o <code>Pictures</code> estes possam se sobrepor aos outros tiros quando usados no jogo.</p><pre> listDisp = disparosEstado . estado $ e
 lasers   = filter (d -&gt; case d of {DisparoLaser{} -&gt; True; _ -&gt; False}) listDisp
 other    = filter (d -&gt; case d of {DisparoLaser{} -&gt; False; _ -&gt; True}) listDisp
 newDispList = other ++ lasers 
</pre><p>A fun&#231;&#227;o auxiliar recebe um disparos e o <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> e se for um laser ent&#227;o chama a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:drawLaserPath">drawLaserPath</a></code>, se n&#227;o for chama a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:resizeTiro">resizeTiro</a></code></p><pre> aux :: EstadoGloss -&gt; Disparo -&gt; Picture
 aux e d@(DisparoLaser n pos dir) = drawLaserPath e d
 aux e p = resizeTiro e p (pictureTiro e p)

</pre></div></div><div class="top"><p class="src"><a id="v:drawLaserPath" class="def">drawLaserPath</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Disparo">Disparo</a> -&gt; Picture <a href="#v:drawLaserPath" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que permite desenhar o laser no Jogo.</p><p>A fun&#231;&#227;o calcula todas as posi&#231;&#245;es indestrutiveis do mapa: </p><pre> mapa        = mapaEstado . estado $ e
 allPos      = [(l,c) | l &lt;- [0 .. pred . length $ mapa], c &lt;- [0 .. pred . length . head $ mapa]]
 allPosGroup = groupN allPos $ length . head $ mapa
 allI        = posIndestrutivel mapa allPosGroup
</pre><p>Posteriormente faz o caminho todo do laser com recurso &#224;s fun&#231;&#245;es <code><a href="Tarefa4_2018li1g027.html#v:allPosPath">allPosPath</a></code>, sendo que se usa a fun&#231;&#227;o <code><a href="Tarefa4_2018li1g027.html#v:shotAsTwoBlocks">shotAsTwoBlocks</a></code> para fazer o laser contar com 2 blocos em vez de 1, testando se atinge um bloco indestrutivel, guardando todas as posi&#231;&#245;es.</p><pre> laser          = tail $ laserPath (pos,dir) allI 
 tuploAsTwoPos  = map (uncurry shotAsTwoBlocks) [(pos,dir)]
 (pathNC, path) = (map (flip allPosPath allI) tuploAsTwoPos, nub . concat $ pathNC)
</pre><p>A lista de posi&#231;&#245;es &#233; obtida atrav&#233;s do uso da fun&#231;&#227;o <code>take</code> de metade <code>length</code> do path, pois o path s&#227;o as posi&#231;&#245;es do laser como 2 blocos e apenas pretende-se ficar com as <code><a href="LI11819.html#t:PosicaoGrelha">PosicaoGrelha</a></code> da lista. Assim resolve-se o problema de ter o laser em v&#225;rias posi&#231;&#245;es e faz o teste se embate ou n&#227;o nu bloco indestrut&#237;vel de forma correta.</p><pre>laserCaminho = take (div (length path) 2) path</pre><p>A fun&#231;&#227;o auxiliar recebe a lista de lasers e envia para a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:resizeTiro">resizeTiro</a></code> em cada posi&#231;&#227;o.</p><pre> aux :: EstadoGloss -&gt; Disparo -&gt; [Posicao] -&gt; [Picture]
 aux e d [] = []
 aux e d@(DisparoLaser n pos dir) (h:t) = resizeTiro e d (pictureTiro e d) : aux e (DisparoLaser n h dir) t
</pre></div></div><div class="top"><p class="src"><a id="v:resizeTiro" class="def">resizeTiro</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Disparo">Disparo</a> -&gt; Picture -&gt; Picture <a href="#v:resizeTiro" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve a picture do tiro na posi&#231;&#227;o correta e com o tamanho correto.</p><p>Se o tiro for um Choque ent&#227;o, como a imagem &#233; 6 vezes maior que uma pe&#231;a s&#243; &#233; preciso dar resize da imagem para o tamanho de uma pe&#231;a no jogo e ele automaticamente ocupa uma &#225;rea 6x6.</p><pre>resTiroChoque = scale sizeToScale sizeToScale pic</pre><p>Posteriormente o laser &#233; colocado na posi&#231;&#227;o do jogador da mesma forma que acontece no <code><a href="DesenhaJogo.html#v:desenhaTank">desenhaTank</a></code>.</p><pre> (i,j)           = (posX + (realPixelSize <em> 2) + realPixelSize*fromIntegral b, posY + (realPixelSize </em> 2) + realPixelSize * fromIntegral a)
 translateChoque = Translate i (-j) resTiroChoque
</pre><p>A diferen&#231;a para os outros tipos de tiro &#233; que &#233; necess&#225;rio um resize diferente e fazer uma rota&#231;&#227;o de acordo com a sua dire&#231;&#227;o</p><pre> resTiroCL = scale (sizeToScale/2) sizeToScale pic
 rotateCL  = rotate (direcaoToAngle dir) resTiroCL
    
</pre></div></div><div class="top"><p class="src"><a id="v:pictureTiro" class="def">pictureTiro</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="LI11819.html#t:Disparo">Disparo</a> -&gt; Picture <a href="#v:pictureTiro" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve a picture do tiro na lista de <code><a href="Typos.html#v:imagensJogo">imagensJogo</a></code>.</p><p>Como s&#227;o 4 imagens para cada tiro, sendo elas, para os 4 tipos de tanque, e est&#227;o guardadas apartir do 7 &#237;ndice da lista ent&#227;o ao &#237;ndice do jogador soma-se 7 para ir buscar as imagens dos canh&#245;es, soma-se 11 para ir buscar os lasers e 15 para os choques.</p></div></div><h1 id="g:6">Fun&#231;&#245;es para desenhar o contador de ticks.</h1><div class="top"><p class="src"><a id="v:drawTicksCounter" class="def">drawTicksCounter</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture <a href="#v:drawTicksCounter" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha o contador de ticks no fundo da tela do jogo.</p><p>Os ticks s&#227;o guardados no par&#226;metro <code><a href="Typos.html#v:tickCounter">tickCounter</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code>. Usa-se a fun&#231;&#227;o <code>show</code> para transformar esse <strong>Int</strong> numa <strong>String</strong> e envia-se para a fun&#231;&#227;o auxiliar a <strong>String</strong> ap&#243;s se usar a fun&#231;&#227;o reverse, o valor 0 e o <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code>.</p><pre>Pictures $ aux (reverse listcharTick) 0 e</pre><p>Utiliza-se o reverse para se colocar o n&#250;mero do contador quando entra nas dezenas ou centas se v&#225; alargando para a esquerda.</p><pre> aux :: String -&gt; Float -&gt; EstadoGloss -&gt; [Picture]
 aux [] _ _ = []
 aux (h:t) n e = desenhaTick e n (pictureTick e h) : aux t (n+1.0) e
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaTick" class="def">desenhaTick</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Float -&gt; Picture -&gt; Picture <a href="#v:desenhaTick" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha um Tick.</p><p>Esta fun&#231;&#227;o calcula um novo espa&#231;o para o contador retirando &#224; altura da tela o tamanho do mapa e divindo esse espa&#231;o por 4 ficando o contador mesmo por baixo do mapa.</p><pre> newEspacoForTick = (fromIntegral y - realPixelSize * (fromIntegral . length $ mapa))/4</pre><p>Posteriormente a vari&#225;vel para dar <code>Scale</code> ao tick &#233; alterada para ser em fun&#231;&#227;o do tamanho desse novo espa&#231;o para que o tick seja redimensionado ao alterar-se o tamanho da tela.</p><pre> scaleNewEspaco  = newEspacoForTick/fromIntegral y
 resTickPic      = scale scaleNewEspaco scaleNewEspaco pic
 pixelSizeOfTick = scaleNewEspaco * 600
</pre><p>De facto, define-se uma vari&#225;vel que seja o tamanho do tick em pixeis e multiplica-se o valor n para que seja corretamente colocado quando o valor passa por exemplo de 9 para 10.</p><pre> sumTranslate  = n * pixelSizeOfTick
 translateTick = Translate (-sumTranslate + pixelSizeOfTick) ((-realPixelSize * (fromIntegral . length $ mapa))<em>2 - pixelSizeOfTick</em>1.5) resTickPic 
</pre></div></div><div class="top"><p class="src"><a id="v:pictureTick" class="def">pictureTick</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Char -&gt; Picture <a href="#v:pictureTick" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que devolve a picture corresponde ao tick na lista <code><a href="Typos.html#v:imagensTickCounter">imagensTickCounter</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code>.</p></div></div><h1 id="g:7">Fun&#231;&#245;es para desenhar os powerups.</h1><div class="top"><p class="src"><a id="v:desenhaPowerUps" class="def">desenhaPowerUps</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; [Picture] <a href="#v:desenhaPowerUps" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha os powerups no jogo.</p><p>&#201; criada uma vari&#225;vel que guarda a lista de <code><a href="Typos.html#v:powerups">powerups</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> e envia cada powerup para a fun&#231;&#227;o auxiliar juntamente com o <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> atual. Este &#233; depois redimensionado pela fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:resizePowerUp">resizePowerUp</a></code> e a sua picture &#233; obtida pela <code><a href="DesenhaJogo.html#v:picturePowerUp">picturePowerUp</a></code>.</p></div></div><div class="top"><p class="src"><a id="v:resizePowerUp" class="def">resizePowerUp</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="Typos.html#t:Powerup">Powerup</a> -&gt; Picture -&gt; Picture <a href="#v:resizePowerUp" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que redimensiona o tamanho do powerup para ser menor que o tamanho de uma pe&#231;a para ficar colocada numa <code><a href="LI11819.html#t:PosicaoGrelha">PosicaoGrelha</a></code>.</p><pre>resPU = scale (sizeToScale/8) ( sizeToScale/8) pic</pre><p>Assim sofre uma transla&#231;&#227;o igual &#224; dos tanques ou dos tiros e &#233; colocada no lugar correto.</p><pre>(i,j) = (posX + (realPixelSize / 2) +realPixelSize * fromIntegral b , posY + (realPixelSize / 2) + realPixelSize*fromIntegral a)</pre></div></div><div class="top"><p class="src"><a id="v:picturePowerUp" class="def">picturePowerUp</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; <a href="Typos.html#t:Powerup">Powerup</a> -&gt; Picture <a href="#v:picturePowerUp" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que vai buscar a picture correspondente ao powerup &#224; lista de <code><a href="Typos.html#v:imagensPowerUps">imagensPowerUps</a></code> do par&#226;metro <code><a href="Typos.html#v:imagens">imagens</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code>.</p></div></div><h1 id="g:8">Fun&#231;&#245;es para desenhar o estado dos jogadores.</h1><div class="top"><p class="src"><a id="v:getEstados" class="def">getEstados</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture <a href="#v:getEstados" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o respons&#225;vel pelo desenho dos estados dos jogadores.</p><p>Esta obt&#233;m a lista de jogadores atr&#225;ves do <code><a href="LI11819.html#t:Estado">Estado</a></code> do <code><a href="Typos.html#t:EstadoGloss">EstadoGloss</a></code> e envia para uma auxiliar que desenha cada estado, come&#231;ando no jogador 0.</p><pre> aux :: [Jogador] -&gt; Int -&gt; EstadoGloss -&gt; [Picture]
 aux [] _ _ = []
 aux (h:t) a e = desenhaEstadoJog e a : aux t (a+1) e
</pre></div></div><div class="top"><p class="src"><a id="v:desenhaEstadoJog" class="def">desenhaEstadoJog</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Int -&gt; Picture <a href="#v:desenhaEstadoJog" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha um estado individual, sendo que, dependo do indice do jogador desenha num dos cantos da tela do jogo.</p><p>Se for o jogador 0 ser&#225; colocado no canto <strong>superior direito</strong>.</p><p>Se for o jogador 1 ser&#225; colocado no canto <strong>inferior direito</strong>.</p><p>Se for o jogador 2 ser&#225; colocado no canto <strong>superior esquerdo</strong>.</p><p>Se for o jogador 3 ser&#225; colocado no canto <strong>inferior esquerdo</strong>.</p><p>Esta fun&#231;&#227;o calcula o espa&#231;o ao lado do mapa que fica reservado para os estados. Assim estes s&#227;o colocados nesse espa&#231;o e ficam dependetes do tamanho desse espa&#231;o. Desta forma, se a tela for maximizada eles ficam corretamente colocados nos cantos da tela e aumentam de tamanho.</p><pre> newEspacoForEstado = (fromIntegral x-pixelPS * (fromIntegral . length . head $ mapa))/2
 newSizeToResize    = newEspacoForEstado / 900
</pre><p>Assim, sofrem uma transla&#231;ao em que ficam encostados &#224;s partes laterais da tela mas ficam com um espa&#231;o em rela&#231;&#227;o ao fundo e ao topo da tela.</p><pre>(a,b) = (fromIntegral x /2 - sizeOfPixelEstado / 2,fromIntegral y / 2 - sizeOfPixelEstado/1.5)</pre></div></div><div class="top"><p class="src"><a id="v:estadoJog" class="def">estadoJog</a> :: Int -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture <a href="#v:estadoJog" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que vai buscar &#224;s <code><a href="Typos.html#v:imagensJogo">imagensJogo</a></code> a imagem do estado do tanque correspondente.</p></div></div><div class="top"><p class="src"><a id="v:desenhaInfo" class="def">desenhaInfo</a> :: Int -&gt; Float -&gt; Float -&gt; Float -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Picture -&gt; Picture <a href="#v:desenhaInfo" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que desenha o n&#250;mero de vidas, lasers e choques e os coloca no lugar certo do estado.</p><p>Neste caso &#233; usada uma estrat&#233;gia semelhante ao <code><a href="DesenhaJogo.html#v:drawTicksCounter">drawTicksCounter</a></code> em que se cria uma string para as vidas, lasers e choque do jogador usando a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:resizeVLC">resizeVLC</a></code> para desenhar as pictures correpondentes aos n&#250;meros, redimensionando-os e posteriormente coloca-os no lugar correto.</p><pre> jog             = flip (!!) n . jogadoresEstado . estado $ e
 vidas           = show . vidasJogador $ jog
 laser           = show . lasersJogador $ jog
 choque          = show . choquesJogador $ jog
 infoAfterResize = resizeVLC vidas laser choque e sizeOfPixelEstado a b
</pre></div></div><div class="top"><p class="src"><a id="v:resizeVLC" class="def">resizeVLC</a> :: String -&gt; String -&gt; String -&gt; <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; Float -&gt; Float -&gt; Float -&gt; Picture <a href="#v:resizeVLC" class="selflink">#</a></p><div class="doc"><p>Esta fun&#231;&#227;o redimensiona as imagens das informa&#231;&#245;es para que estas sejam colocadas no lugar correto do estado.</p><p>Assim &#233; necess&#225;rio que o tamanho a redimensionar seja em fun&#231;&#227;o do tamanho do estado do jogador e &#233; preciso saber qual a transla&#231;&#227;o do estado correspondente. Por outras palavras, &#233; preciso saber os valor usados
na transla&#231;&#227;o dos estados na fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:desenhaEstadoJog">desenhaEstadoJog</a></code> para que as informa&#231;&#245;es sejam colocadas no estado correto.</p><pre> translateNumber  = 400 * spe / 600
 translateNumberY = 160 * spe / 400

 picVida    = Pictures . reverse $ placeN e vidas 0 pixelNumberSize scaleVidas x y (-2.0)
 picLaser   = Pictures . reverse $ placeN e laser 0 pixelNumberSize scaleLaser x y (-1.0)
 picChoques = Pictures . reverse $ placeN e choque 0 pixelNumberSize scaleChoque x y 1.5
</pre><p>Obs: x e y s&#227;o os valores da transla&#231;&#227;o do estado.</p></div></div><div class="top"><p class="src"><a id="v:placeN" class="def">placeN</a> :: <a href="Typos.html#t:EstadoGloss">EstadoGloss</a> -&gt; String -&gt; Int -&gt; Float -&gt; Float -&gt; Float -&gt; Float -&gt; Float -&gt; [Picture] <a href="#v:placeN" class="selflink">#</a></p><div class="doc"><p>Fun&#231;&#227;o que coloca uma informa&#231;&#227;o no lugar certo dentro do estado.</p><p>Esta recebe um multiplicador de tipo, ou seja, o valor que &#233; necess&#225;rio para colocar a inform&#231;&#227;o ao lado da imagem que aparece dentro de estado relativa a essa informa&#231;&#227;o.</p><pre>(a,b) = (x - s + fromIntegral n / 2 * s, y + s * multplicadorDeTipo)</pre><p>Esta fun&#231;&#227;o tamb&#233;m utiliza a fun&#231;&#227;o <code><a href="DesenhaJogo.html#v:pictureTick">pictureTick</a></code> para obter o n&#250;mero correspondente ao n&#250;mero de vidas, lasers e choques.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.3</p></div></body></html>